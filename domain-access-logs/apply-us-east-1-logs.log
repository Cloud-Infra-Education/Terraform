[0m[1mdata.archive_file.lambda_zip: Reading...[0m[0m
[0m[1mdata.archive_file.lambda_zip: Read complete after 0s [id=b79a2ea4f2628645b98b6a9f60f435cc464b0a84][0m
[0m[1mdata.aws_caller_identity.current: Reading...[0m[0m
[0m[1maws_iam_role.lambda_exec_role: Refreshing state... [id=y2om-route53-dns-log-lambda-role][0m
[0m[1mdata.aws_caller_identity.current: Read complete after 0s [id=404457776061][0m
[0m[1mdata.aws_caller_identity.us_east_1: Reading...[0m[0m
[0m[1mdata.aws_caller_identity.us_east_1: Read complete after 1s [id=404457776061][0m
[0m[1maws_iam_role_policy.lambda_basic_execution: Refreshing state... [id=y2om-route53-dns-log-lambda-role:y2om-lambda-basic-execution][0m
[0m[1maws_opensearch_domain.route53_logs: Refreshing state... [id=arn:aws:es:ap-northeast-2:404457776061:domain/y2om-route53-dns-logs][0m
[0m[1maws_iam_role_policy.lambda_opensearch_access: Refreshing state... [id=y2om-route53-dns-log-lambda-role:y2om-lambda-opensearch-access][0m
[0m[1maws_lambda_function.route53_log_processor: Refreshing state... [id=y2om-route53-dns-log-processor][0m
[0m[1maws_lambda_permission.allow_cloudwatch_logs: Refreshing state... [id=AllowExecutionFromCloudWatchLogs][0m

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  [32m+[0m create[0m
[31m-[0m/[32m+[0m destroy and then create replacement[0m

Terraform will perform the following actions:

[1m  # aws_cloudwatch_log_group.route53_query_logs[0m will be created
[0m  [32m+[0m[0m resource "aws_cloudwatch_log_group" "route53_query_logs" {
      [32m+[0m[0m arn               = (known after apply)
      [32m+[0m[0m id                = (known after apply)
      [32m+[0m[0m log_group_class   = (known after apply)
      [32m+[0m[0m name              = "/aws/route53/y2om-query-logs"
      [32m+[0m[0m name_prefix       = (known after apply)
      [32m+[0m[0m retention_in_days = 7
      [32m+[0m[0m skip_destroy      = false
      [32m+[0m[0m tags              = {
          [32m+[0m[0m "Name" = "y2om-Route53 Query Logs"
        }
      [32m+[0m[0m tags_all          = {
          [32m+[0m[0m "Name" = "y2om-Route53 Query Logs"
        }
    }

[1m  # aws_cloudwatch_log_resource_policy.route53_logs_policy[0m will be created
[0m  [32m+[0m[0m resource "aws_cloudwatch_log_resource_policy" "route53_logs_policy" {
      [32m+[0m[0m id              = (known after apply)
      [32m+[0m[0m policy_document = (known after apply)
      [32m+[0m[0m policy_name     = "y2om-route53-query-logging-policy"
    }

[1m  # aws_cloudwatch_log_subscription_filter.lambda_trigger[0m will be created
[0m  [32m+[0m[0m resource "aws_cloudwatch_log_subscription_filter" "lambda_trigger" {
      [32m+[0m[0m destination_arn = "arn:aws:lambda:ap-northeast-2:404457776061:function:y2om-route53-dns-log-processor"
      [32m+[0m[0m distribution    = "ByLogStream"
      [32m+[0m[0m id              = (known after apply)
      [32m+[0m[0m log_group_name  = "/aws/route53/y2om-query-logs"
      [32m+[0m[0m name            = "y2om-route53-log-to-lambda"
      [32m+[0m[0m role_arn        = (known after apply)
    }

[1m  # aws_lambda_permission.allow_cloudwatch_logs[0m must be [1m[31mreplaced[0m
[0m[31m-[0m/[32m+[0m[0m resource "aws_lambda_permission" "allow_cloudwatch_logs" {
      [33m~[0m[0m id                  = "AllowExecutionFromCloudWatchLogs" -> (known after apply)
      [32m+[0m[0m source_account      = "404457776061" [31m# forces replacement[0m[0m
      [33m~[0m[0m source_arn          = "arn:aws:logs:ap-northeast-2:404457776061:log-group:/aws/route53/y2om-query-logs:*" [31m# forces replacement[0m[0m -> (known after apply) [31m# forces replacement[0m[0m
      [32m+[0m[0m statement_id_prefix = (known after apply)
        [90m# (4 unchanged attributes hidden)[0m[0m
    }

[1m  # aws_route53_query_log.main[0m will be created
[0m  [32m+[0m[0m resource "aws_route53_query_log" "main" {
      [32m+[0m[0m arn                      = (known after apply)
      [32m+[0m[0m cloudwatch_log_group_arn = (known after apply)
      [32m+[0m[0m id                       = (known after apply)
      [32m+[0m[0m zone_id                  = "Z038651135MZFV9GL29ON"
    }

[1mPlan:[0m 5 to add, 0 to change, 1 to destroy.
[0m
Changes to Outputs:
  [33m~[0m[0m cloudwatch_log_group_arn = "arn:aws:logs:ap-northeast-2:404457776061:log-group:/aws/route53/y2om-query-logs" -> (known after apply)
  [33m~[0m[0m route53_query_log_id     = "c2aeb84c-ce52-475d-9b72-78abd6ba9f26" -> (known after apply)
[0m[1maws_lambda_permission.allow_cloudwatch_logs: Destroying... [id=AllowExecutionFromCloudWatchLogs][0m[0m
[0m[1maws_lambda_permission.allow_cloudwatch_logs: Destruction complete after 0s[0m
[0m[1maws_cloudwatch_log_group.route53_query_logs: Creating...[0m[0m
[31mâ•·[0m[0m
[31mâ”‚[0m [0m[1m[31mError: [0m[0m[1mcreating CloudWatch Logs Log Group (/aws/route53/y2om-query-logs): operation error CloudWatch Logs: CreateLogGroup, https response error StatusCode: 400, RequestID: 4eba7191-eaa3-4622-a9aa-d61e2bbe0f09, ResourceAlreadyExistsException: The specified log group already exists[0m
[31mâ”‚[0m [0m
[31mâ”‚[0m [0m[0m  with aws_cloudwatch_log_group.route53_query_logs,
[31mâ”‚[0m [0m  on cloudwatch.tf line 3, in resource "aws_cloudwatch_log_group" "route53_query_logs":
[31mâ”‚[0m [0m   3: resource "aws_cloudwatch_log_group" "route53_query_logs" [4m{[0m[0m
[31mâ”‚[0m [0m
[31mâ•µ[0m[0m
