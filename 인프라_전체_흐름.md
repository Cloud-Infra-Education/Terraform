# ì¸í”„ë¼ ì „ì²´ íë¦„ ê°€ì´ë“œ

## ê°œìš”

ì´ ë¬¸ì„œëŠ” Terraformìœ¼ë¡œ êµ¬ì¶•ë˜ëŠ” ì „ì²´ ì¸í”„ë¼ì˜ íë¦„ê³¼ ê° ë‹¨ê³„ë³„ ì—­í• ì„ ì„¤ëª…í•©ë‹ˆë‹¤.

---

## ğŸ“‹ ì¸í”„ë¼ êµ¬ì¶• ìˆœì„œ

### 1ë‹¨ê³„: ê¸°ë³¸ ì¸í”„ë¼ (01-infra)

**ëª©ì **: ë„¤íŠ¸ì›Œí¬ ê¸°ë°˜ êµ¬ì¶• ë° ìŠ¤í† ë¦¬ì§€ ì¤€ë¹„

**êµ¬ì„± ìš”ì†Œ**:
- **VPC (Virtual Private Cloud)**
  - ì„œìš¸ ë¦¬ì „: `kor_vpc_id`
  - ì˜¤ë ˆê³¤ ë¦¬ì „: `usa_vpc_id`
  - ê° ë¦¬ì „ë³„ Public/Private ì„œë¸Œë„· êµ¬ì„±
  - Transit Gatewayë¥¼ í†µí•œ ë¦¬ì „ ê°„ ì—°ê²°

- **S3 ë²„í‚·**
  - CloudFront Originìš© ë²„í‚· ìƒì„±
  - ì •ì  ì›¹ì‚¬ì´íŠ¸ í˜¸ìŠ¤íŒ…ìš©

**ì¶œë ¥ (Remote State)**:
- `kor_vpc_id`, `usa_vpc_id`
- `kor_private_eks_subnet_ids`, `usa_private_eks_subnet_ids`
- `kor_private_db_subnet_ids`, `usa_private_db_subnet_ids`
- `origin_bucket_name`

**ì˜ì¡´ì„±**: ì—†ìŒ (ìµœì´ˆ ì‹¤í–‰)

---

### 2ë‹¨ê³„: Kubernetes í´ëŸ¬ìŠ¤í„° (02-kubernetes)

**ëª©ì **: ì»¨í…Œì´ë„ˆ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ í™˜ê²½ êµ¬ì¶•

**êµ¬ì„± ìš”ì†Œ**:
- **EKS (Elastic Kubernetes Service)**
  - ì„œìš¸ ë¦¬ì „: `y2om-formation-lap-seoul`
  - ì˜¤ë ˆê³¤ ë¦¬ì „: `y2om-formation-lap-oregon`
  - ë²„ì „: Kubernetes 1.34
  - Node Groups: t3.large (Seoul), t3.small (Oregon)

- **Cluster Autoscaler**
  - IRSA (IAM Roles for Service Accounts) ì„¤ì •
  - ìë™ ë…¸ë“œ ìŠ¤ì¼€ì¼ë§

**ì¶œë ¥ (Remote State)**:
- `seoul_cluster_name`, `oregon_cluster_name`
- `seoul_oidc_provider_arn`, `oregon_oidc_provider_arn`
- `seoul_eks_workers_sg_id`, `oregon_eks_workers_sg_id`

**ì˜ì¡´ì„±**: `01-infra` (VPC, ì„œë¸Œë„· í•„ìš”)

---

### 3ë‹¨ê³„: ë°ì´í„°ë² ì´ìŠ¤ (03-database)

**ëª©ì **: ì• í”Œë¦¬ì¼€ì´ì…˜ ë°ì´í„° ì €ì¥ì†Œ êµ¬ì¶•

**êµ¬ì„± ìš”ì†Œ**:
- **RDS Aurora MySQL**
  - Multi-AZ ë°°í¬
  - ì„œìš¸ ë¦¬ì „ì— Primary, ì˜¤ë ˆê³¤ ë¦¬ì „ì— Replica
  - ìë™ ë°±ì—… ë° ìŠ¤ëƒ…ìƒ·

- **RDS Proxy**
  - ì—°ê²° í’€ë§
  - Secrets Managerì™€ ì—°ë™í•˜ì—¬ ìë™ ì¸ì¦
  - EKS ì›Œì»¤ ë…¸ë“œì—ì„œ ì ‘ê·¼ ê°€ëŠ¥

- **Secrets Manager**
  - DB ë¹„ë°€ë²ˆí˜¸ ì €ì¥
  - ìë™ ë¡œí…Œì´ì…˜ ì„¤ì •

**ì¶œë ¥ (Remote State)**:
- `kor_db_proxy_endpoint`
- `usa_db_proxy_endpoint`
- `db_cluster_endpoint`

**ì˜ì¡´ì„±**: 
- `01-infra` (VPC, ì„œë¸Œë„·)
- `02-kubernetes` (EKS ì›Œì»¤ ë…¸ë“œ Security Group)

---

### 4ë‹¨ê³„: Kubernetes Addons (04-addons)

**ëª©ì **: EKS í´ëŸ¬ìŠ¤í„°ì— í•„ìˆ˜ ì• ë“œì˜¨ ì„¤ì¹˜

**êµ¬ì„± ìš”ì†Œ**:
- **AWS Load Balancer Controller**
  - ALB Ingress Controller
  - IRSAë¥¼ í†µí•œ IAM ê¶Œí•œ ë¶€ì—¬
  - ALB ìë™ ìƒì„± ë° ê´€ë¦¬

- **Cluster Autoscaler**
  - Helm Chartë¥¼ í†µí•œ ë°°í¬
  - IRSA ì„¤ì •

**ì¶œë ¥ (Remote State)**:
- ALB Controllerê°€ Ingress ë¦¬ì†ŒìŠ¤ë¥¼ ì²˜ë¦¬í•  ì¤€ë¹„ ì™„ë£Œ

**ì˜ì¡´ì„±**: `02-kubernetes` (EKS í´ëŸ¬ìŠ¤í„° í•„ìš”)

---

### 5ë‹¨ê³„: ArgoCD (05-argocd)

**ëª©ì **: GitOps ê¸°ë°˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬ ìë™í™”

**êµ¬ì„± ìš”ì†Œ**:
- **ArgoCD Helm Chart**
  - ì„œìš¸ ë° ì˜¤ë ˆê³¤ ë¦¬ì „ì— ë°°í¬
  - Git Repository ì—°ë™
  - ìë™ ë™ê¸°í™” ì„¤ì •

- **ArgoCD Application**
  - Git Repositoryì—ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ ë§¤ë‹ˆí˜ìŠ¤íŠ¸ ì½ê¸°
  - Kubernetes ë¦¬ì†ŒìŠ¤ ìë™ ë°°í¬

**ì¶œë ¥ (Remote State)**:
- ArgoCD ì„œë²„ ì ‘ê·¼ ì •ë³´

**ì˜ì¡´ì„±**: `02-kubernetes` (EKS í´ëŸ¬ìŠ¤í„° í•„ìš”)

---

### 6ë‹¨ê³„: SSL ì¸ì¦ì„œ (06-certificate)

**ëª©ì **: HTTPS í†µì‹ ì„ ìœ„í•œ SSL/TLS ì¸ì¦ì„œ ë°œê¸‰

**êµ¬ì„± ìš”ì†Œ**:
- **ACM (AWS Certificate Manager)**
  - `api.exampleott.click` (ì„œìš¸ ë¦¬ì „)
  - `api.exampleott.click` (ì˜¤ë ˆê³¤ ë¦¬ì „)
  - `www.exampleott.click` (CloudFrontìš©, us-east-1)

- **Route53 DNS ê²€ì¦**
  - DNS ë ˆì½”ë“œë¥¼ í†µí•œ ì¸ì¦ì„œ ê²€ì¦
  - ìë™ ê²€ì¦ ì™„ë£Œ ëŒ€ê¸°

**ì¶œë ¥ (Remote State)**:
- `acm_arn_api_seoul`
- `acm_arn_api_oregon`
- `acm_arn_www`
- `dvo_api_seoul`, `dvo_api_oregon`, `dvo_www` (DNS ê²€ì¦ ì •ë³´)

**ì˜ì¡´ì„±**: 
- `01-infra` (Route53 Hosted Zone)
- ë„ë©”ì¸ ì†Œìœ ê¶Œ í™•ì¸ í•„ìš”

---

### 7ë‹¨ê³„: ë„ë©”ì¸ ë° ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬ (07-domain-cf)

**ëª©ì **: ë„ë©”ì¸ ì„¤ì •, CloudFront êµ¬ì„±, Backend API ë° Meilisearch ë°°í¬

**êµ¬ì„± ìš”ì†Œ**:

#### 7.1 CloudFront
- **CloudFront Distribution**
  - S3 Origin (ì •ì  ì›¹ì‚¬ì´íŠ¸)
  - Origin Access Control (OAC) ì„¤ì •
  - SSL ì¸ì¦ì„œ ì—°ë™

#### 7.2 Route53 ë ˆì½”ë“œ
- `www.exampleott.click` â†’ CloudFront Distribution
- `api.exampleott.click` â†’ ALB (ì„œìš¸/ì˜¤ë ˆê³¤)

#### 7.3 ALB Ingress
- **Kubernetes Ingress ë¦¬ì†ŒìŠ¤**
  - `/api/v1/*` â†’ Backend API Service
  - `/docs` â†’ Backend API Service
  - SSL ì¸ì¦ì„œ ìë™ ì ìš©
  - WAF ì—°ë™

#### 7.4 Backend API ë°°í¬
- **Kubernetes Deployment**
  - ECR ì´ë¯¸ì§€ ì‚¬ìš©
  - í™˜ê²½ ë³€ìˆ˜: Keycloak, Meilisearch, Database ì—°ê²° ì •ë³´
  - ConfigMap ë° Secret ì‚¬ìš©

- **Kubernetes Service**
  - ClusterIP íƒ€ì…
  - í¬íŠ¸: 8000

#### 7.5 Meilisearch ë°°í¬
- **Kubernetes Deployment**
  - `getmeili/meilisearch:latest` ì´ë¯¸ì§€
  - í¬íŠ¸: 7700
  - Master Key ì„¤ì •

- **Kubernetes Service**
  - `meilisearch-service` (ClusterIP)
  - Backend APIì—ì„œ `http://meilisearch-service:7700`ë¡œ ì ‘ê·¼

**ì¶œë ¥ (Remote State)**:
- CloudFront Distribution ID
- ALB DNS ì´ë¦„

**ì˜ì¡´ì„±**: 
- `01-infra` (S3, VPC)
- `02-kubernetes` (EKS í´ëŸ¬ìŠ¤í„°)
- `03-database` (RDS Proxy ì—”ë“œí¬ì¸íŠ¸)
- `04-addons` (ALB Controller)
- `06-certificate` (ACM ì¸ì¦ì„œ)

---

### 8ë‹¨ê³„: Global Accelerator (08-domain-ga)

**ëª©ì **: ê¸€ë¡œë²Œ íŠ¸ë˜í”½ ìµœì í™” ë° ê³ ê°€ìš©ì„±

**êµ¬ì„± ìš”ì†Œ**:
- **AWS Global Accelerator**
  - ì„œìš¸ ë° ì˜¤ë ˆê³¤ ALBë¥¼ ì—”ë“œí¬ì¸íŠ¸ë¡œ ë“±ë¡
  - Anycast IP ì œê³µ
  - ìë™ ì¥ì•  ì¡°ì¹˜

**ì¶œë ¥ (Remote State)**:
- Global Accelerator DNS ì´ë¦„

**ì˜ì¡´ì„±**: `07-domain-cf` (ALB ìƒì„± í•„ìš”)

---

### 9ë‹¨ê³„: ë„ë©”ì¸ ì ‘ê·¼ ë¡œê·¸ (09-domain-access-logs)

**ëª©ì **: DNS ì¿¼ë¦¬ ë¡œê·¸ ìˆ˜ì§‘ ë° ë¶„ì„

**êµ¬ì„± ìš”ì†Œ**:
- **Route53 Query Logging**
  - CloudWatch Logsë¡œ ë¡œê·¸ ì „ì†¡

- **Lambda í•¨ìˆ˜**
  - CloudWatch Logs íŠ¸ë¦¬ê±°
  - DNS ì¿¼ë¦¬ íŒŒì‹± ë° OpenSearch ì¸ë±ì‹±

- **OpenSearch Domain**
  - DNS ì¿¼ë¦¬ ë°ì´í„° ì €ì¥
  - ëŒ€ì‹œë³´ë“œë¥¼ í†µí•œ ì‹œê°í™”

**ì¶œë ¥ (Remote State)**:
- OpenSearch Dashboard URL
- Lambda í•¨ìˆ˜ ì´ë¦„

**ì˜ì¡´ì„±**: `01-infra` (Route53 Hosted Zone)

---

### 10ë‹¨ê³„: ì• í”Œë¦¬ì¼€ì´ì…˜ ëª¨ë‹ˆí„°ë§ (10-app-monitoring)

**ëª©ì **: ë¡œê·¸, ë©”íŠ¸ë¦­, íŠ¸ë ˆì´ìŠ¤ ìˆ˜ì§‘ ë° ëª¨ë‹ˆí„°ë§

**êµ¬ì„± ìš”ì†Œ**:
- **Loki**
  - ë¡œê·¸ ìˆ˜ì§‘ ë° ì €ì¥
  - S3 ë°±ì—”ë“œ ì‚¬ìš©

- **Mimir**
  - ë©”íŠ¸ë¦­ ìˆ˜ì§‘ ë° ì €ì¥
  - Prometheus í˜¸í™˜

- **Tempo**
  - ë¶„ì‚° ì¶”ì  (Distributed Tracing)
  - OTLP í”„ë¡œí† ì½œ ì§€ì›

- **Grafana**
  - í†µí•© ëŒ€ì‹œë³´ë“œ
  - Loki, Mimir, Tempo ë°ì´í„° ì‹œê°í™”

- **Alloy**
  - ë¡œê·¸, ë©”íŠ¸ë¦­, íŠ¸ë ˆì´ìŠ¤ ìˆ˜ì§‘ ì—ì´ì „íŠ¸
  - Kubernetes Pod ë¡œê·¸ ìë™ ìˆ˜ì§‘

**ì¶œë ¥ (Remote State)**:
- Grafana ì ‘ê·¼ ì •ë³´
- Loki, Mimir, Tempo ì—”ë“œí¬ì¸íŠ¸

**ì˜ì¡´ì„±**: `02-kubernetes` (EKS í´ëŸ¬ìŠ¤í„° í•„ìš”)

---

## ğŸ”„ ë°ì´í„° íë¦„

### ì‚¬ìš©ì ìš”ì²­ íë¦„

```
1. ì‚¬ìš©ì
   â†“
2. DNS ì¿¼ë¦¬ (Route53)
   â”œâ”€ www.exampleott.click â†’ CloudFront â†’ S3 (ì •ì  ì›¹ì‚¬ì´íŠ¸)
   â””â”€ api.exampleott.click â†’ ALB (ì„œìš¸/ì˜¤ë ˆê³¤)
   â†“
3. ALB Ingress Controller
   â†“
4. Backend API Pod (EKS)
   â”œâ”€ Keycloak (ì¸ì¦)
   â”œâ”€ Meilisearch (ê²€ìƒ‰)
   â””â”€ RDS Proxy â†’ RDS Aurora (ë°ì´í„°ë² ì´ìŠ¤)
```

### ì¸ì¦ íë¦„

```
1. ì‚¬ìš©ì ë¡œê·¸ì¸ ìš”ì²­
   â†“
2. Backend API
   â†“
3. Keycloak (JWT í† í° ë°œê¸‰)
   â†“
4. Backend API (JWT ê²€ì¦)
   â”œâ”€ JWKS ì—”ë“œí¬ì¸íŠ¸ì—ì„œ ê³µê°œí‚¤ ê°€ì ¸ì˜¤ê¸°
   â”œâ”€ kid (Key ID) ë§¤ì¹­
   â””â”€ ì„œëª… ê²€ì¦
   â†“
5. Database (Emailë¡œ user_id ì¡°íšŒ)
   â†“
6. API ì‘ë‹µ
```

### ê²€ìƒ‰ íë¦„

```
1. ì‚¬ìš©ì ê²€ìƒ‰ ìš”ì²­ (/api/v1/search?q=test)
   â†“
2. Backend API
   â†“
3. Meilisearch Service
   â”œâ”€ Kubernetes DNS: meilisearch-service:7700
   â””â”€ ê²€ìƒ‰ ìˆ˜í–‰
   â†“
4. Database (ê²€ìƒ‰ ê²°ê³¼ ìƒì„¸ ì •ë³´ ì¡°íšŒ)
   â†“
5. API ì‘ë‹µ
```

---

## ğŸ—ï¸ ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ì‚¬ìš©ì (ì¸í„°ë„·)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                               â”‚
        â–¼                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Route53 DNS  â”‚              â”‚  CloudFront    â”‚
â”‚               â”‚              â”‚  (www.example) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                            â”‚
        â”‚                            â–¼
        â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                    â”‚   S3 Bucket   â”‚
        â”‚                    â”‚  (ì •ì  ì›¹ì‚¬ì´íŠ¸) â”‚
        â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ALB (Application Load Balancer)          â”‚
â”‚                    (api.exampleott.click)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                               â”‚
        â–¼                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  EKS Seoul    â”‚              â”‚  EKS Oregon   â”‚
â”‚               â”‚              â”‚               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚              â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ Backend   â”‚â”‚              â”‚ â”‚ Backend   â”‚â”‚
â”‚ â”‚ API Pod   â”‚â”‚              â”‚ â”‚ API Pod   â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜â”‚              â”‚ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜â”‚
â”‚       â”‚      â”‚              â”‚       â”‚      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”â”‚              â”‚ â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚Meilisearchâ”‚â”‚              â”‚ â”‚Meilisearchâ”‚â”‚
â”‚ â”‚   Pod     â”‚â”‚              â”‚ â”‚   Pod     â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚              â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚               â”‚              â”‚               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚              â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ Keycloak  â”‚â”‚              â”‚ â”‚ Keycloak  â”‚â”‚
â”‚ â”‚   Pod     â”‚â”‚              â”‚ â”‚   Pod     â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚              â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                               â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                               â”‚
        â–¼                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RDS Proxy    â”‚              â”‚  RDS Proxy    â”‚
â”‚   (Seoul)     â”‚              â”‚   (Oregon)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                               â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  RDS Aurora     â”‚
              â”‚  MySQL Cluster  â”‚
              â”‚  (Primary Seoul)â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ ì£¼ìš” ì„¤ì • íŒŒì¼ ìœ„ì¹˜

### Terraform ìŠ¤íƒ
- `01-infra/`: ë„¤íŠ¸ì›Œí¬, S3
- `02-kubernetes/`: EKS í´ëŸ¬ìŠ¤í„°
- `03-database/`: RDS, RDS Proxy
- `04-addons/`: ALB Controller
- `05-argocd/`: ArgoCD
- `06-certificate/`: ACM ì¸ì¦ì„œ
- `07-domain-cf/`: CloudFront, ë„ë©”ì¸, Backend API, Meilisearch
- `08-domain-ga/`: Global Accelerator
- `09-domain-access-logs/`: DNS ë¡œê·¸
- `10-app-monitoring/`: ëª¨ë‹ˆí„°ë§ ìŠ¤íƒ

### ëª¨ë“ˆ
- `modules/network/`: VPC, ì„œë¸Œë„·, Transit Gateway
- `modules/eks/`: EKS í´ëŸ¬ìŠ¤í„°
- `modules/database/`: RDS, RDS Proxy
- `modules/domain/`: Backend API ë°°í¬, Meilisearch ë°°í¬, Ingress
- `modules/addons/`: ALB Controller
- `modules/argocd/`: ArgoCD
- `modules/app-monitoring/`: Loki, Mimir, Tempo, Grafana

---

## ğŸš€ ë°°í¬ ìˆœì„œ ìš”ì•½

1. **01-infra**: ë„¤íŠ¸ì›Œí¬ ê¸°ë°˜ êµ¬ì¶•
2. **02-kubernetes**: EKS í´ëŸ¬ìŠ¤í„° ìƒì„±
3. **03-database**: RDS ë° RDS Proxy ì„¤ì •
4. **04-addons**: ALB Controller ì„¤ì¹˜
5. **05-argocd**: ArgoCD ì„¤ì¹˜ (ì„ íƒì‚¬í•­)
6. **06-certificate**: SSL ì¸ì¦ì„œ ë°œê¸‰
7. **07-domain-cf**: ë„ë©”ì¸ ì„¤ì •, Backend API ë° Meilisearch ë°°í¬
8. **08-domain-ga**: Global Accelerator ì„¤ì • (ì„ íƒì‚¬í•­)
9. **09-domain-access-logs**: DNS ë¡œê·¸ ìˆ˜ì§‘ (ì„ íƒì‚¬í•­)
10. **10-app-monitoring**: ëª¨ë‹ˆí„°ë§ ìŠ¤íƒ (ì„ íƒì‚¬í•­)

---

## âš ï¸ ì£¼ì˜ì‚¬í•­

1. **ìˆœì„œ ì¤€ìˆ˜**: ê° ë‹¨ê³„ëŠ” ì´ì „ ë‹¨ê³„ì˜ Remote Stateë¥¼ ì°¸ì¡°í•˜ë¯€ë¡œ ìˆœì„œë¥¼ ë°˜ë“œì‹œ ì§€ì¼œì•¼ í•©ë‹ˆë‹¤.
2. **ë„ë©”ì¸ ì†Œìœ ê¶Œ**: `06-certificate` ë‹¨ê³„ì—ì„œ ë„ë©”ì¸ ì†Œìœ ê¶Œ í™•ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.
3. **ë¦¬ì „ë³„ ë¦¬ì†ŒìŠ¤**: ì„œìš¸ê³¼ ì˜¤ë ˆê³¤ ë¦¬ì „ì— ê°ê° ë¦¬ì†ŒìŠ¤ê°€ ë°°í¬ë©ë‹ˆë‹¤.
4. **ë¹„ìš©**: ê° ë‹¨ê³„ë³„ë¡œ AWS ë¦¬ì†ŒìŠ¤ ë¹„ìš©ì´ ë°œìƒí•©ë‹ˆë‹¤.
5. **ì˜ì¡´ì„±**: `07-domain-cf`ëŠ” ì—¬ëŸ¬ ì´ì „ ë‹¨ê³„ì˜ ì¶œë ¥ì„ í•„ìš”ë¡œ í•©ë‹ˆë‹¤.

---

## ğŸ” ë¬¸ì œ í•´ê²°

### Meilisearch ì—°ê²° ì‹¤íŒ¨
- Pod ìƒíƒœ í™•ì¸: `kubectl get pods -n formation-lap -l app=meilisearch`
- Service í™•ì¸: `kubectl get svc -n formation-lap meilisearch-service`
- Backend API í™˜ê²½ ë³€ìˆ˜ í™•ì¸: `kubectl exec -n formation-lap <backend-pod> -- env | grep MEILISEARCH`

### Backend API ì—°ê²° ì‹¤íŒ¨
- Pod ë¡œê·¸ í™•ì¸: `kubectl logs -n formation-lap -l app=backend-api --tail=50`
- Database ì—°ê²° í™•ì¸: RDS Proxy ì—”ë“œí¬ì¸íŠ¸ ë° Secrets Manager í™•ì¸
- Keycloak ì—°ê²° í™•ì¸: Keycloak Pod ìƒíƒœ ë° í™˜ê²½ ë³€ìˆ˜ í™•ì¸

### ALB Ingress ë¬¸ì œ
- Ingress ë¦¬ì†ŒìŠ¤ í™•ì¸: `kubectl get ingress -n formation-lap`
- ALB Controller ë¡œê·¸: `kubectl logs -n kube-system -l app.kubernetes.io/name=aws-load-balancer-controller`

---

## ğŸ“š ì¶”ê°€ ì°¸ê³  ìë£Œ

- [Backend API README.md](/root/Backend/README.md): Backend API ì‚¬ìš© ê°€ì´ë“œ
- [Terraform README.md](/root/Terraform/README.md): Terraform í”„ë¡œì íŠ¸ ê°€ì´ë“œ
- [Meilisearch ê³µì‹ ë¬¸ì„œ](https://www.meilisearch.com/docs): Meilisearch ì‚¬ìš©ë²•
